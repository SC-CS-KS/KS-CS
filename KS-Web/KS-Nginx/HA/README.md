# Nginx HA

***[百万并发下的Nginx优化](http://developer.51cto.com/art/201811/586741.htm?tdsourcetag=s_pcqq_aiomsg)***
```md
百万并发下的Nginx优化
	优化目标
		保持并发连接数
			怎么样做到内存有效使用
		高吞吐
			在高并发的同时保持高吞吐量的重要要点
			
				每秒处理请求书
				每秒传输字节数
				每秒处理报文数
		低延时
	优化方案
		主机软件层面
			最大化硬件资源的使用效率
				降低进程间切换
				资源的高效使用
				多CPU利用
				不使用内核网络栈
			
				应用
					协议
						更换高效协议
							HTTP2
							WebSocket
						压缩
						Keepalive 长连接
					提高内存使用率
					限速
						不是限上游发请求的速度，而是在限从上游接响应的速度
					Worker 间负载均衡
						
							
					超时
					缓存
					减少磁盘 IO
						优化读取，Sendfile 零拷贝、内存盘、SSD 盘
						减少写入，AIO，磁盘是远大于内存的
				框架
				内核
					提升容量配置
					CPU缓存的亲和性
					NUMA 架构的 CPU 亲和性
					网络快速容错
					TCP 协议优化
					提高资源效率
					提升多 CPU 使用效率
		专有硬件
		集群方案
			DNS
```