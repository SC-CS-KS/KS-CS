# API Gateway
```md
在微服务中，广泛会使用到API网关
	可以认为是一系列服务集合的访问入口
从面向对象设计的角度看，它与外观模式类似，实现对所提供服务的封装
API网关本身不提供服务的具体实现
	它根据请求，将服务分发到具体的实现上
```

* 作用
```md
API路由
	 接受到请求时，将请求转发到具体实现的worker机器上
	避免使用方建立大量的连接
协议转换
封装公共功能
	将微服务治理相关功能封装到网关上
		简化微服务的开发，这包括熔断、限流、身份验证、监控、负载均衡、缓存等
分流
	通过控制API网关的分发策略
		可以很容易实现访问的分流，这在灰度测试和AB测试时特别有用
```
* 解耦合
```md
RPC API网关在实现上，难点在于如何做到服务无关
	我们知道使用Nginx实现HTTP的路由网关，可以实现和服务无关
	而RPC网关由于实现上的不规范，很难实现和服务无关
统一使用Thrift + Protobuf 来开发RPC服务可以简化API网关的开发
	避免为每个服务上线而带来的网关的调整，使得网关和具体的服务解耦合
```
```md
每个服务实现的worker机器将服务注册到ZooKeeper上
API网关接收到ZooKeeper的变更
	更新本地的路由表，记录服务和worker（连接池）的映射关系
当请求被提交到网关上时
	网关可以从rpc请求中提取出服务名称，之后根据这个名称，找到对应的worker机（连接池）
	调用该worker上的服务，接受到结果后，将结果返回给调用方
```
* 权限和其他
