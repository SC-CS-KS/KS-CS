# 分布式事务
```md
数据库的事务处理对象是本地事务，而分布式事务处理的对象是全局事务。
```
* 全局事务
```md
是指分布式事务处理环境中，多个数据库可能需要共同完成一个工作，这个工作即是一个全局事务。
一个事务中可能更新几个不同的数据库，对数据库的操作发生在系统的各处但必须全部被提交或回滚。
```
* 设计思路
```md
一般情况下，某一数据库无法知道其它数据库在做什么。
因此，在一个 DTP 环境中，交易中间件是必需的，由它通知和协调相关数据库的提交或回滚。
而一个数据库只将其自己所做的操作（可恢复）影射到全局事务中。
```
* XA规范
```md
Open Group定义了一套DTP分布式模型，主要含有AP（应用程序）,TM（事务管理器）,
RM（资源管理器）,CRM（通讯资源管理器）四部分。
常规下RM一般指的就是数据库，CRM主要有各种各样的消息中间件来实现。

XA则是DTP模型定义TM和RM之前通讯的接口规范。
XA接口函数由数据库厂商提供。TM交易中间件用它来通知数据库事务的开始、结束以及提交、回滚等。

二阶段提交和三阶段提交就是根据这种思想衍生而来。
```

## 角色
* 协调者（Cooradinator）
```md
协调者负责调度参与者的行为，并最终决定这些参与者是否要把事务进行提交。
```
* 参与者（Participant）