# Object Pool

## WhatIs
### 背景
```md
Java 中创建对象分配内存所花费的时间与C++相比是昂贵的。
```
* 解决方案
```md
1. 尽量在程序中使用Java提供的基本类型
2. 尽量实现“对象重用”
3. 还可以利用一些设计模式提供的思路，如“单例模式”（需要在特定的需求下），“享元模式”（FlyWeight）。
4. 利用“对象池”来管理维护Java小对象，适用于多个进程在不同时间对一些“行为相似”的小对象有大量需求的情况。
```
* 优势
```md
不再需要创建对象，节省了加载时间（Load Time）
使用完对象之后将其归还给“对象池”继续保存管理，于是减少了“垃圾收集”(Garbage Collection)的开销。
```
### Design
```md
	存储和管理已经“外借”的对象
	存储和管理“在库”对象
```
```md
数据结构由两个HashTable维护，分别是“locked”和“unlocked”。
key值就是对象本身的引用，value值为“上次使用时间”（Last-Usage Time）。
		
对于locked，value值为“上次外借时间”
对于unlocked，value值为“上次归还时间”
```
```md
通过保存对象的“上次使用时间”信息，对象池在对象的上次使用时间与当前时间之差超出消亡期限的情况下，
将该对象“消灭”，以减少保存“不再使用对象”带来的内存开销。
这个消亡期限作为ObjectPool的一个成员变量在子类的构造器中初始化。
```